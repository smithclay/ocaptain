# User-local binaries
if [[ -d "$HOME/.local/bin" ]]; then
  path=("$HOME/.local/bin" $path)
fi

# Claude alias - fetches OAuth token from flagship
claude() {
  local flagship token
  if [[ -f "$HOME/.ocaptain/config.json" ]]; then
    flagship=$(jq -r '.flagship // empty' "$HOME/.ocaptain/config.json" 2>/dev/null)
  fi
  if [[ "$flagship" == "localhost" ]]; then
    token=$(sudo cat /etc/ocaptain/claude_token 2>/dev/null)
  elif [[ -n "$flagship" ]]; then
    token=$(ssh "$flagship" 'sudo cat /etc/ocaptain/claude_token 2>/dev/null' 2>/dev/null)
  fi
  if [[ -n "$token" ]]; then
    CLAUDE_CODE_OAUTH_TOKEN="$token" command claude --dangerously-skip-permissions "$@"
  else
    command claude --dangerously-skip-permissions "$@"
  fi
}
